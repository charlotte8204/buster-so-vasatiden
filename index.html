<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vasatiden - Buster</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#f1f5f9;--card:#fff;--text:#1e293b;--muted:#64748b;
  --accent:#2563eb;--success:#16a34a;--danger:#dc2626;--warning:#f59e0b;
  --sidebar:#1e293b;--sidebar-text:#e2e8f0;
  --radius:10px;--shadow:0 2px 12px rgba(0,0,0,.08);
}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:18px;line-height:1.6;color:var(--text);background:var(--bg);min-height:100vh}
.container{max-width:900px;margin:0 auto;padding:24px}
header{text-align:center;padding:32px 0 24px}
header h1{font-size:2.4em;font-weight:800;color:var(--sidebar);letter-spacing:-1px}
header p{font-size:1.1em;color:var(--muted);margin-top:8px}
.points-bar{display:flex;justify-content:center;gap:16px;margin:16px 0;flex-wrap:wrap}
.points-bar .badge{background:var(--card);border-radius:20px;padding:8px 18px;font-weight:600;font-size:.95em;box-shadow:var(--shadow);display:flex;align-items:center;gap:6px}
.badge.gold{color:var(--warning)}
.badge.blue{color:var(--accent)}

/* Timeline */
.timeline{background:var(--card);border-radius:var(--radius);padding:24px 28px;margin:20px 0;box-shadow:var(--shadow)}
.timeline h2{font-size:1.15em;margin-bottom:16px;color:var(--sidebar)}
.tl-track{position:relative;display:flex;justify-content:space-between;padding:0 10px;margin-bottom:8px}
.tl-track::before{content:'';position:absolute;top:10px;left:10px;right:10px;height:4px;background:linear-gradient(90deg,var(--accent),var(--success));border-radius:2px}
.tl-dot{position:relative;text-align:center;flex:0 0 auto}
.tl-dot .dot{width:14px;height:14px;background:var(--accent);border:3px solid var(--card);border-radius:50%;margin:3px auto 6px;position:relative;z-index:1;box-shadow:0 0 0 2px var(--accent)}
.tl-dot .yr{font-size:.7em;font-weight:700;color:var(--danger)}
.tl-dot .lbl{font-size:.6em;color:var(--muted);max-width:80px;line-height:1.2}

/* Checklist */
.checklist{background:var(--card);border-radius:var(--radius);padding:24px 28px;margin:20px 0;box-shadow:var(--shadow)}
.checklist h2{font-size:1.15em;margin-bottom:14px;color:var(--sidebar)}
.checklist ul{list-style:none}
.checklist li{padding:8px 0;border-bottom:1px solid #f1f5f9;display:flex;align-items:flex-start;gap:10px;font-size:.95em}
.checklist li:last-child{border:none}
.checklist li .check{color:var(--muted);font-size:1.1em;flex-shrink:0;margin-top:2px}
.checklist li.done .check{color:var(--success)}

/* Sections */
.sections{display:grid;gap:14px;margin:20px 0}
.section-card{background:var(--card);border-radius:var(--radius);padding:18px 22px;box-shadow:var(--shadow);display:flex;align-items:center;gap:16px;text-decoration:none;color:var(--text);transition:transform .15s,box-shadow .15s;cursor:pointer;border:2px solid transparent}
.section-card:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.12)}
.section-card.active{border-color:var(--accent)}
.section-card .num{width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.1em;color:#fff;flex-shrink:0}
.section-card .num.blue{background:var(--accent)}
.section-card .num.green{background:var(--success)}
.section-card .num.orange{background:var(--warning)}
.section-card .num.red{background:var(--danger)}
.section-card .num.purple{background:#7c3aed}
.section-card .num.teal{background:#0d9488}
.section-card .num.exam{background:linear-gradient(135deg,var(--accent),#7c3aed);font-size:.9em}
.section-card .info{flex:1}
.section-card .info h3{font-size:1em;font-weight:700;margin-bottom:2px}
.section-card .info p{font-size:.8em;color:var(--muted);margin:0}
.section-card .status{font-size:.85em;font-weight:600;padding:4px 12px;border-radius:12px;white-space:nowrap}
.status.not-started{background:#f1f5f9;color:var(--muted)}
.status.in-progress{background:#dbeafe;color:var(--accent)}
.status.done{background:#dcfce7;color:var(--success)}

.divider{text-align:center;padding:10px 0;color:var(--muted);font-size:.85em;font-weight:600;letter-spacing:1px;text-transform:uppercase}

.footer{text-align:center;padding:20px 0;font-size:.85em;color:var(--muted)}
.footer a{color:var(--accent);text-decoration:none;font-weight:600}
.footer a:hover{text-decoration:underline}

.start-btn{display:block;width:100%;max-width:360px;margin:24px auto;padding:16px 32px;background:var(--accent);color:#fff;border:none;border-radius:var(--radius);font-size:1.1em;font-weight:700;cursor:pointer;text-align:center;text-decoration:none;box-shadow:0 4px 12px rgba(37,99,235,.3);transition:background .2s}
.start-btn:hover{background:#1d4ed8}

.reset-btn{display:inline-block;margin-top:8px;padding:8px 16px;background:#fee2e2;color:var(--danger);border:none;border-radius:6px;font-size:.8em;cursor:pointer;font-weight:600}
.reset-btn:hover{background:#fecaca}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>VASATIDEN</h1>
    <p>Hej Buster! Grymt att du ska lära dig om Vasatiden.</p>
  </header>

  <div class="points-bar">
    <div class="badge gold" id="totalPoints">0 poäng</div>
    <div class="badge blue" id="totalProgress">0 av 6 delar klara</div>
  </div>

  <!-- Timeline -->
  <div class="timeline">
    <h2>Tidslinje - Sverige på 1500-talet</h2>
    <div class="tl-track">
      <div class="tl-dot"><div class="dot"></div><div class="yr">1397</div><div class="lbl">Kalmar-unionen</div></div>
      <div class="tl-dot"><div class="dot"></div><div class="yr">1520</div><div class="lbl">Stockholms blodbad</div></div>
      <div class="tl-dot"><div class="dot"></div><div class="yr">1523</div><div class="lbl">Gustav Vasa kung</div></div>
      <div class="tl-dot"><div class="dot"></div><div class="yr">1527</div><div class="lbl">Reforma-tionen</div></div>
      <div class="tl-dot"><div class="dot"></div><div class="yr">1542</div><div class="lbl">Dacke-upproret</div></div>
      <div class="tl-dot"><div class="dot"></div><div class="yr">1560</div><div class="lbl">Gustav Vasa dör</div></div>
    </div>
  </div>

  <!-- Checklist -->
  <div class="checklist">
    <h2>Vad ska jag kunna?</h2>
    <ul>
      <li id="goal1"><span class="check">&#9744;</span> Veta vad Kalmarunionen var och varför den tog slut</li>
      <li id="goal2"><span class="check">&#9744;</span> Förklara vad Stockholms blodbad var och vad det ledde till</li>
      <li id="goal3"><span class="check">&#9744;</span> Beskriva hur folk levde på Vasatiden</li>
      <li id="goal4"><span class="check">&#9744;</span> Förklara varför Sverige bytte från katolicism till protestantism</li>
      <li id="goal5"><span class="check">&#9744;</span> Förstå varför bönderna gjorde uppror och hur Gustav Vasa hanterade det</li>
      <li id="goal6"><span class="check">&#9744;</span> Resonera om orsaker och konsekvenser av förändringar</li>
      <li id="goal7"><span class="check">&#9744;</span> Kunna diskutera och värdera historiska källor</li>
    </ul>
  </div>

  <!-- Sections -->
  <div class="sections">
    <a href="del1-01-kalmarunionen.html" class="section-card active" id="sec1">
      <div class="num blue">1</div>
      <div class="info">
        <h3>Striden om Sverige</h3>
        <p>Kalmarunionen, Stockholms blodbad och Gustav Vasa</p>
      </div>
      <span class="status not-started" id="sec1-status">Starta</span>
    </a>
    <a href="del2-01-bondernas-liv.html" class="section-card" id="sec2">
      <div class="num green">2</div>
      <div class="info">
        <h3>Livet på Vasatiden</h3>
        <p>Bönder, barnarbete, gruvor och underhållning</p>
      </div>
      <span class="status not-started" id="sec2-status">Starta</span>
    </a>
    <a href="del3-01-kritik-mot-kyrkan.html" class="section-card" id="sec3">
      <div class="num orange">3</div>
      <div class="info">
        <h3>Sverige blir protestantiskt</h3>
        <p>Martin Luther, Olaus Petri och reformationen</p>
      </div>
      <span class="status not-started" id="sec3-status">Starta</span>
    </a>
    <a href="del4-01-uppror-i-smaland.html" class="section-card" id="sec4">
      <div class="num red">4</div>
      <div class="info">
        <h3>Uppror och motstånd</h3>
        <p>Dackeupproret, Nils Dacke och propaganda</p>
      </div>
      <span class="status not-started" id="sec4-status">Starta</span>
    </a>
    <a href="del5-01-kronan-i-arv.html" class="section-card" id="sec5">
      <div class="num purple">5</div>
      <div class="info">
        <h3>Gustav Vasas söner</h3>
        <p>Erik XIV, Johan III, Karl IX och maktkampen</p>
      </div>
      <span class="status not-started" id="sec5-status">Starta</span>
    </a>
    <a href="del6-01-kallor.html" class="section-card" id="sec6">
      <div class="num teal">6</div>
      <div class="info">
        <h3>Källor och historiebruk</h3>
        <p>Hur vet vi vad som hände på Vasatiden?</p>
      </div>
      <span class="status not-started" id="sec6-status">Starta</span>
    </a>

    <div class="divider">- - - Avslutande prov - - -</div>

    <a href="prov.html" class="section-card" id="secProv">
      <div class="num exam">PROV</div>
      <div class="info">
        <h3>Är du redo för provet?</h3>
        <p>Faktadel + resonemangsdel om hela Vasatiden</p>
      </div>
      <span class="status not-started" id="secProv-status">Starta</span>
    </a>
  </div>

  <a href="del1-01-kalmarunionen.html" class="start-btn" id="startBtn">Börja Del 1: Striden om Sverige &rarr;</a>

  <div class="footer">
    <a href="buster-vasatiden-analys.html">Statistik och resultat</a>
    <br>
    <button class="reset-btn" onclick="clearHistory()">Rensa all historik</button>
  </div>
</div>

<script>
const PREFIX = 'buster-vasatiden-';

function getPoints(){
  return parseInt(localStorage.getItem(PREFIX+'points')||'0');
}

function getProgress(){
  return JSON.parse(localStorage.getItem(PREFIX+'progress')||'{}');
}

function clearHistory(){
  if(!confirm('Vill du verkligen rensa all historik? Alla svar och poäng försvinner.')) return;
  Object.keys(localStorage).forEach(k=>{
    if(k.startsWith(PREFIX)) localStorage.removeItem(k);
  });
  location.reload();
}

// Section definitions
const sections = {
  1: {pages:['del1-01','del1-02','del1-03','del1-04','del1-05','del1-quiz'], firstPage:'del1-01-kalmarunionen.html', name:'Striden om Sverige'},
  2: {pages:['del2-01','del2-02','del2-03','del2-04','del2-quiz'], firstPage:'del2-01-bondernas-liv.html', name:'Livet på Vasatiden'},
  3: {pages:['del3-01','del3-02','del3-03','del3-04','del3-05','del3-quiz'], firstPage:'del3-01-kritik-mot-kyrkan.html', name:'Sverige blir protestantiskt'},
  4: {pages:['del4-01','del4-02','del4-03','del4-quiz'], firstPage:'del4-01-uppror-i-smaland.html', name:'Uppror och motstånd'},
  5: {pages:['del5-01','del5-02','del5-03','del5-04','del5-05','del5-quiz'], firstPage:'del5-01-kronan-i-arv.html', name:'Gustav Vasas söner'},
  6: {pages:['del6-01','del6-02','del6-quiz'], firstPage:'del6-01-kallor.html', name:'Källor och historiebruk'}
};

const fileMap = {
  'del1-01':'del1-01-kalmarunionen.html','del1-02':'del1-02-maktkampen.html',
  'del1-03':'del1-03-kristina-gyllenstierna.html','del1-04':'del1-04-stockholms-blodbad.html',
  'del1-05':'del1-05-gustav-vasa-blir-kung.html','del1-quiz':'del1-quiz.html',
  'del2-01':'del2-01-bondernas-liv.html','del2-02':'del2-02-barn-och-arbete.html',
  'del2-03':'del2-03-gruvorna.html','del2-04':'del2-04-fest-och-lek.html','del2-quiz':'del2-quiz.html',
  'del3-01':'del3-01-kritik-mot-kyrkan.html','del3-02':'del3-02-martin-luther.html',
  'del3-03':'del3-03-olaus-petri.html','del3-04':'del3-04-kungen-tar-kyrkans-saker.html',
  'del3-05':'del3-05-klockupproret.html','del3-quiz':'del3-quiz.html',
  'del4-01':'del4-01-uppror-i-smaland.html','del4-02':'del4-02-nils-dacke.html',
  'del4-03':'del4-03-propaganda.html','del4-quiz':'del4-quiz.html',
  'del5-01':'del5-01-kronan-i-arv.html','del5-02':'del5-02-erik-xiv.html',
  'del5-03':'del5-03-johan-och-katolicismen.html','del5-04':'del5-04-karl-tar-makten.html',
  'del5-05':'del5-05-cecilia-vasa.html','del5-quiz':'del5-quiz.html',
  'del6-01':'del6-01-kallor.html','del6-02':'del6-02-sammanfattning.html','del6-quiz':'del6-quiz.html'
};

function updateUI(){
  const pts = getPoints();
  document.getElementById('totalPoints').textContent = pts + ' poäng';

  const progress = getProgress();
  let sectionsComplete = 0;
  let firstIncomplete = null;

  // Update each section
  for(let s = 1; s <= 6; s++){
    const sec = sections[s];
    const done = sec.pages.filter(p => progress[p] === true);
    const statusEl = document.getElementById('sec'+s+'-status');
    const cardEl = document.getElementById('sec'+s);

    if(done.length === sec.pages.length){
      statusEl.textContent = 'Klar!';
      statusEl.className = 'status done';
      sectionsComplete++;
    } else if(done.length > 0){
      statusEl.textContent = done.length + '/' + sec.pages.length;
      statusEl.className = 'status in-progress';
      if(!firstIncomplete){
        const nextPage = sec.pages.find(p => !progress[p]);
        firstIncomplete = {section: s, page: nextPage, name: sec.name};
      }
    } else {
      if(!firstIncomplete){
        firstIncomplete = {section: s, page: sec.pages[0], name: sec.name};
      }
    }

    // Make card link to next unfinished page in section
    if(done.length > 0 && done.length < sec.pages.length){
      const nextPage = sec.pages.find(p => !progress[p]);
      if(nextPage && fileMap[nextPage]) cardEl.href = fileMap[nextPage];
    }
  }

  document.getElementById('totalProgress').textContent = sectionsComplete + ' av 6 delar klara';

  // Update prov status
  const provStatus = document.getElementById('secProv-status');
  if(progress['prov']){
    provStatus.textContent = 'Klar!';
    provStatus.className = 'status done';
  }

  // Update start button
  const startBtn = document.getElementById('startBtn');
  if(sectionsComplete === 6){
    if(progress['prov']){
      startBtn.textContent = 'Allt klart! Fantastiskt jobbat Buster!';
      startBtn.style.background = 'var(--success)';
      startBtn.href = 'buster-vasatiden-analys.html';
    } else {
      startBtn.textContent = 'Alla delar klara! Gör provet \u2192';
      startBtn.style.background = '#7c3aed';
      startBtn.href = 'prov.html';
    }
  } else if(firstIncomplete){
    const page = firstIncomplete.page;
    startBtn.href = fileMap[page] || sections[firstIncomplete.section].firstPage;
    if(firstIncomplete.section === 1 && !progress['del1-01']){
      startBtn.textContent = 'Börja Del 1: ' + firstIncomplete.name + ' \u2192';
    } else {
      startBtn.textContent = 'Fortsätt Del ' + firstIncomplete.section + ': ' + firstIncomplete.name + ' \u2192';
    }
  }

  // Update checklist goals
  if(sectionsComplete >= 1) markGoal('goal1');
  if(sectionsComplete >= 1) markGoal('goal2');
  if(sectionsComplete >= 2) markGoal('goal3');
  if(sectionsComplete >= 3) markGoal('goal4');
  if(sectionsComplete >= 4) markGoal('goal5');
  if(sectionsComplete >= 5) markGoal('goal6');
  if(sectionsComplete >= 6) markGoal('goal7');
}

function markGoal(id){
  const el = document.getElementById(id);
  if(el){
    el.classList.add('done');
    el.querySelector('.check').innerHTML = '&#9745;';
  }
}

updateUI();
</script>
</body>
</html>
